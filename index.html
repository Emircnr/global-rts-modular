<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MEXC Spot ↔ Perp Arbitraj Farkı — Tek Dosya</title>
  <style>
    :root{
      --bg: #0b0f14;
      --panel: #111720;
      --card: #0f1520;
      --muted: #94a3b8;
      --text: #e6edf3;
      --good: #22c55e;
      --bad:  #ef4444;
      --warn: #f59e0b;
      --accent: #60a5fa;
      --border: #1f2937;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background: radial-gradient(1200px 800px at 80% -10%, rgba(96,165,250,.12), transparent 60%) , var(--bg);
      color: var(--text); font: 500 15px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      letter-spacing:.1px;
    }
    header{display:flex; align-items:center; justify-content:space-between; gap:16px; padding:22px clamp(14px,4vw,34px)}
    .brand{display:flex; align-items:center; gap:14px;}
    .logo{
      width:38px;height:38px;border-radius:12px;
      background: conic-gradient(from 200deg,#1f2937,#0ea5e9,#22d3ee,#1f2937); box-shadow: inset 0 0 0 2px #0b1220, var(--shadow);
    }
    h1{margin:0; font-size:18px; font-weight:700; letter-spacing:.4px}
    .grid{display:grid; gap:18px; padding:0 clamp(14px,4vw,34px) 28px; grid-template-columns: 320px 1fr}
    @media (max-width: 980px){ .grid{grid-template-columns: 1fr} }
    .panel{background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.005)); border:1px solid var(--border);
      border-radius: var(--radius); box-shadow: var(--shadow); padding:16px}
    .panel h2{margin:6px 6px 12px; font-size:14px; color:var(--muted); font-weight:700; text-transform:uppercase; letter-spacing:.14em}
    .row{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
    .row3{display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px}
    label{display:block; font-size:12px; color:var(--muted); margin:8px 6px 6px}
    input, select, button{
      width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--border); background:#0c121a; color:var(--text);
      outline:none; transition: .15s border, .15s transform, .15s background;
    }
    input:focus, select:focus{border-color:#334155}
    .muted{color:var(--muted)}
    .small{font-size:12px}
    .ghost{background:#0b1119}
    .btn{cursor:pointer; background: linear-gradient(180deg,#1f6feb,#1b4ed4); border:none}
    .btn:hover{transform: translateY(-1px)}
    .btn.stop{background: linear-gradient(180deg,#ef4444,#b91c1c)}
    .cards{display:grid; grid-template-columns: repeat(2, minmax(260px,1fr)); gap:14px}
    @media (max-width: 760px){ .cards{grid-template-columns:1fr} }
    .card{background: linear-gradient(180deg, rgba(15,21,32,.8), rgba(10,14,22,.8)); border:1px solid var(--border);
      border-radius: var(--radius); padding:14px 14px 12px; box-shadow: var(--shadow)}
    .card h3{margin:0 0 10px; font-size:13px; color:var(--muted); text-transform:uppercase; letter-spacing:.14em}
    .ticker{display:flex; align-items:baseline; gap:10px}
    .price{font-size:28px; font-weight:800; letter-spacing:.3px}
    .pill{display:inline-flex; align-items:center; gap:6px; padding:4px 8px; background:#0c121a; border:1px solid var(--border);
      border-radius:999px; font-size:12px; color:var(--muted)}
    .flex{display:flex; align-items:center; gap:10px; flex-wrap:wrap}
    .kv{display:grid; grid-template-columns: auto 1fr; gap:6px 12px; font-size:13px; margin-top:8px}
    .kv .k{color:var(--muted); text-align:right}
    .delta.up{color: var(--good)} .delta.down{color:var(--bad)}
    .spread{display:grid; gap:14px}
    .spread .box{padding:14px; border-radius:16px; border:1px solid var(--border); background:linear-gradient(180deg,#0c121a,#0b0f14)}
    .spread .title{display:flex; align-items:center; justify-content:space-between}
    .spread .big{
      font-size:26px; font-weight:900; letter-spacing:.3px
    }
    .ok{color:var(--good)} .ko{color:var(--bad)} .warn{color:var(--warn)}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace}
    footer{padding:10px 24px 26px; color:var(--muted); text-align:center}
    .hint{font-size:12px; color:var(--muted); margin:8px 6px}
    .link{color:var(--accent); text-decoration:none}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>MEXC Spot ↔ Perp Arbitraj Farkı</h1>
        <div class="small muted">Anlık en iyi fiyatlar · Maker/Taker ücretleri dahil net fark</div>
      </div>
    </div>
    <div class="flex">
      <button id="startBtn" class="btn">Başlat</button>
      <button id="stopBtn" class="btn stop ghost">Durdur</button>
    </div>
  </header>

  <main class="grid">
    <!-- Sol: Ayarlar -->
    <section class="panel" aria-label="Ayarlar">
      <h2>Ayarlar</h2>

      <label for="spotSymbol">Spot Sembol (MEXC):</label>
      <input id="spotSymbol" value="BTCUSDT" class="mono" />

      <div class="hint small">Perp sembolünü otomatik <code>BTC_USDT</code> formatına çevirir; gerekirse düzenleyin.</div>

      <label for="perpSymbol">Perp Sembol (MEXC Futures):</label>
      <input id="perpSymbol" value="BTC_USDT" class="mono" />

      <div class="row">
        <div>
          <label for="qtyMode">Miktar Modu:</label>
          <select id="qtyMode">
            <option value="base">Baz (BTC, ETH...)</option>
            <option value="quote">Notional (USDT)</option>
          </select>
        </div>
        <div>
          <label for="qty">Miktar:</label>
          <input id="qty" type="number" step="any" value="0.01" />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="pollMs">Spot REST Sıklığı (ms):</label>
          <input id="pollMs" type="number" min="150" step="50" value="600" />
        </div>
        <div>
          <label for="decimals">Yuvarlama (görüntü):</label>
          <input id="decimals" type="number" min="0" max="8" value="2" />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="spotSide">Spot Emir Tipi:</label>
          <select id="spotSide">
            <option value="taker">Taker</option>
            <option value="maker">Maker</option>
          </select>
        </div>
        <div>
          <label for="perpSide">Perp Emir Tipi:</label>
          <select id="perpSide">
            <option value="taker">Taker</option>
            <option value="maker">Maker</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label for="spotTakerFee">Spot Taker Ücreti (oran):</label>
          <input id="spotTakerFee" type="number" step="0.0001" value="0.0010" />
        </div>
        <div>
          <label for="spotMakerFee">Spot Maker Ücreti (oran):</label>
          <input id="spotMakerFee" type="number" step="0.0001" value="0.0010" />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="perpTakerFee">Perp Taker Ücreti (oran):</label>
          <input id="perpTakerFee" type="number" step="0.0001" value="0.0006" />
        </div>
        <div>
          <label for="perpMakerFee">Perp Maker Ücreti (oran):</label>
          <input id="perpMakerFee" type="number" step="0.0001" value="0.0002" />
        </div>
      </div>

      <div class="row">
        <button id="applyFeesBtn" class="ghost">Perp ücretlerini API’den çek</button>
        <div class="hint small">Bazı semboller için <em>contract detail</em> ile maker/taker otomatik dolacaktır.</div>
      </div>

      <div class="hint small">UYARI: Demo amaçlıdır. Emir göndermeyecek, sadece hesap yapacaktır.</div>
    </section>

    <!-- Sağ: Canlı kartlar ve hesaplamalar -->
    <section class="panel">
      <h2>Canlı Veriler & Hesap</h2>

      <div class="cards">
        <div class="card">
          <h3>Spot — <span id="spotName" class="mono
